--  기존 테이블 쓰지 않고 새로운 테이블 만들어서 넣기...

CREATE TABLE DEPT_TEMP
 AS SELECT * FROM DEPT;
SELECT * FROM DEPT_TEMP;

-- EMP 테이블 데이터를 그대로 들고와서 TABLE만들기 EMP_TEMP10
CREATE TABLE EMP_TEMP10 
AS SELECT * FROM EMP;

SELECT * FROM EMP_TEMP10;


-- INSERT

INSERT INTO DEPT_TEMP (DEPTNO, DNAME,LOC) VALUES (50,'DATABASE','SEOUL');
SELECT * FROM DEPT_TEMP;

INSERT INTO DEPT_TEMP (DEPTNO, DNAME,LOC) VALUES (70,'NETWORK',NULL);

CREATE TABLE EMP_TEMP
 AS SELECT * FROM EMP WHERE 1 = 0;
 SELECT * FROM EMP_TEMP;
 
 INSERT INTO EMP_TEMP (EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO)
 VALUES (9999,'홍길동','PRESIDENT',NULL,'2023/02/27',5000,1000,10);
 
 INSERT INTO EMP_TEMP (EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO)
 VALUES (9999,'이몽룡','PRESIDENT',NULL,'2023-02-27',5000,1000,10);
 
 INSERT INTO EMP_TEMP (EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO)
 VALUES (9999,'전우치','PRESIDENT',NULL,TO_DATE('27/02/2023','DD/MM/YYYY'),5000,1000,10);
 
 INSERT INTO EMP_TEMP (EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO)
 VALUES (9999,'임꺽정','PRESIDENT',NULL,SYSDATE,5000,1000,10);
 
 
 INSERT INTO EMP_TEMP 
 VALUES (8888,'성춘향','PRESIDENT',NULL,SYSDATE,5000,1000,10);
 
 INSERT INTO EMP_TEMP (EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO)
 VALUES ((SELECT MAX(EMPNO) - 10 FROM EMP_TEMP),'성춘향','PRESIDENT',NULL,SYSDATE,5000,1000,10);
 
 SELECT MAX(EMPNO) + 1 FROM EMP_TEMP;
 
 SELECT * FROM EMP_TEMP;
 
 -- update
 CREATE TABLE DEPT_TEMP02 AS SELECT * FROM DEPT;
 
 UPDATE DEPT_TEMP02 SET LOC = 'SEOUL';
 
 UPDATE DEPT_TEMP02 SET DNAME= 'DATABASE', LOC = 'ILSAN'
 WHERE DEPTNO = 40;
 
 SELECT * FROM DEPT_TEMP02;
 
 COMMIT;  -- TRANSACTION
 
 ROLLBACK;
 
 CREATE TABLE EMP_TEMP11 AS SELECT * FROM EMP;
 
 -- EMP_TEMP11 급여가 2500 이하인 사람의 COMM 50으로 수정
 
 UPDATE EMP_TEMP11 SET COMM = 50 WHERE SAL<=2500;
 
 SELECT * FROM EMP_TEMP11;
 
 UPDATE DEPT_TEMP02 SET 
 DNAME = (SELECT DNAME FROM DEPT WHERE DEPTNO = 40),
 LOC = (SELECT LOC FROM DEPT WHERE DEPTNO = 40)
 WHERE DEPTNO = 40;
 
 UPDATE DEPT_TEMP02 SET 
 (DNAME, LOC) = (SELECT DNAME,loc FROM DEPT WHERE DEPTNO = 40)
  WHERE DEPTNO = 40;
  
DELETE FROM EMP_TEMP10
WHERE JOB = 'MANAGER';
 ROLLBACK;
 SELECT * FROM EMP_TEMP10;
 
 --  EMP_TEMP10에서 급여가 3000 이상인 사람 정리해고 하기...
 
 DELETE FROM EMP_TEMP10
 WHERE SAL >= 3000;



DROP TABLE EMP_TEMP11;

--- CH10PRACTICE
-- CH10 01
CREATE TABLE CHAP10HW_EMP AS SELECT * FROM EMP;
CREATE TABLE CHAP10HW_DEPT AS SELECT * FROM DEPT;
CREATE TABLE CHAP10HW_SALGRADE AS SELECT * FROM SALGRADE;

--DROP TABLE 테이블이름

INSERT INTO CHAP10HW_DEPT (DEPTNO,DNAME,LOC) VALUES (50,'ORACLE','BUSAN');
INSERT INTO CHAP10HW_DEPT (DEPTNO,DNAME,LOC) VALUES (60,'SQL','ILSAN');
INSERT INTO CHAP10HW_DEPT (DEPTNO,DNAME,LOC) VALUES (70,'SELECT','BUNDANG');
INSERT INTO CHAP10HW_DEPT (DEPTNO,DNAME,LOC) VALUES (80,'DML','INCHEON');

SELECT * FROM CHAP10HW_EMP;

INSERT INTO CHAP10HW_EMP VALUES 
(7201,'TESTUSER01','MANAGER',7788,TO_DATE('2016-01-02','YYYY-MM-DD'),4500,NULL,50);
 INSERT INTO CHAP10HW_EMP
 VALUES ('7202','TEST_USER2','CLERK','7201','2016-02-21','1800',NULL,'50');
 INSERT INTO CHAP10HW_EMP
 VALUES ('7203','TEST_USER3','ANALYST','7201','2016-04-11','3400',NULL,'60');
 INSERT INTO CHAP10HW_EMP
 VALUES ('7204','TEST_USER4','SALESMAN','7201','2016-05-31','2700','300','60');
 INSERT INTO CHAP10HW_EMP
 VALUES ('7205','TEST_USER5','CLERK','7201','2016-07-20','2600',NULL,'70');
 INSERT INTO CHAP10HW_EMP
 VALUES ('7206','TEST_USER6','CLERK','7201','2016-09-08','2600',NULL,'70');
 INSERT INTO CHAP10HW_EMP
 VALUES ('7207','TEST_USER7','LECTURE','7201','2016-10-28','2300',NULL,'80');
 INSERT INTO CHAP10HW_EMP
 VALUES ('7208','TEST_USER8','STUDENT','7201','2018-03-09','1200',NULL,'80');


--03
SELECT * FROM CHAP10HW_EMP;

SELECT AVG(SAL) FROM CHAP10HW_EMP WHERE DEPTNO = 50;

UPDATE CHAP10HW_EMP SET DEPTNO = 70
WHERE SAL > (SELECT AVG(SAL) FROM CHAP10HW_EMP WHERE DEPTNO = 50);


--03
UPDATE CHAP10HW_EMP SET
SAL = SAL * 1.1,
DEPTNO = 80
WHERE HIREDATE > (SELECT MIN(HIREDATE) FROM CHAP10HW_EMP WHERE DEPTNO = 60); 


--SELECT MIN(HIREDATE) FROM CHAP10HW_EMP WHERE DEPTNO = 60;

--05
DELETE FROM CHAP10HW_EMP
WHERE EMPNO IN (SELECT E.EMPNO
FROM CHAP10HW_EMP E, CHAP10HW_SALGRADE S
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL AND GRADE = 5);

/*
SELECT E.EMPNO
FROM CHAP10HW_EMP E, CHAP10HW_SALGRADE S
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL AND GRADE = 5;
*/



